// ==========================================================
// Layouts
// ==========================================================

html, body, .s-layout  {
	height: 100%;
}
.s-layout {
	.box-sizing;
	display: table;
	width: 100%;
	>.s-layoutRow, >.s-layoutColumn, .s-layoutRow>.s-layoutColumn {
		height: 0.1%;
		position: relative;
	}
	>.s-layoutRow {
		display: table-row;
		height: 0.01em;
    >.s-layoutCell:not(.s-layout) {
      display: table-cell;
    }
		&.s-layoutExpand {
			height: auto;
		}
	}
	>.s-layoutColumn, >.s-layoutRow>.s-layoutColumn {
		display: table-cell;
		height: auto;
		vertical-align: top;
		width: 0.01em;
		&.s-layoutExpand {
			width: 100%;
		}
	}
}
.s-wrapper {
    margin-left: auto;
    margin-right: auto;
}


// ==========================================================
// Responsive Grid System
// ==========================================================

.s-row {
  .clear-fix;
  >*[class*="s-col"] {
    float: left;
    min-height: 1px;
  }
}
.showFeature(@c) {
  .s-@{c}-show {
    &, &[class*="s-button"], &[class*="s-cell"], &li {
      display: none;
    }
  }
}

// Grid System Loop
.generateColumns(@n:@cols, @m:@colsGutter, @i:1) when (@i =< @n) {
  // Percentage Column Gutter
  & when (ispercentage(@m)) {
    .s-col-@{i} {
      @colsSingleWidth: (100% - @m * (@n - 1)) / @n;
      @colsInnerGutter: @m * (@i - 1);
      width: @colsSingleWidth * @i + @colsInnerGutter;
      &.s-col-@{n} {
        width: 100%;
      }
    }
  }
  // Pixel/EM Column Gutter
  & when not (ispercentage(@m)) {
    .s-col-@{i} {
      &, &[class*="s-col"] {
        width: (@i * 100% / @n);
      }
    }
  }
  .generateColumns(@n, @i:@i + 1, @m);
}

// Viewport Features
.viewportFeatures(@c:@class, @cs:@customStyles, @g:@colsGutter, @b:@stackLayout, @wmin:@wrapperMinWidth, @wmax:@wrapperMaxWidth, @wm:@wrapperMargin, @winmin:@windowMinWidth) { 
  
  // Custom Mixin
  & when not (@cs = false) {
    
    @cs();

  }

  // Layout
  .layoutCell(@w) {
    .s-layout>.s-layoutRow>.s-layoutCell {
      min-width: @w;
    }
  }
  & when (@winmin = false) {
    .layoutCell(100%);
  }
  & when (isunit(@wm,'px')) and (isunit(@wmin,'px')),
         (isunit(@wm,'em')) and (isunit(@wmin,'em')),
         (isunit(@wm,'rem')) and (isunit(@wmin,'rem')),
         (isunit(@wm,'%')) and (isunit(@wmin,'%'))
  {
    .s-wrapper {
      .box-sizing(content-box);
    }
    & when (@winmin = false) {
      .layoutCell(@wmin + @wm*2);
    }
  }
  & when not (@winmin = false) {
    .layoutCell(@winmin);
  }

  .s-wrapper {
      min-width: @wmin;
      max-width: @wmax;
      padding-left: @wm;
      padding-right: @wm;
  }

  // Grid System
  & when (ispercentage(@g)) {
    .s-row > *[class*="s-col"] + *[class*="s-col"] {
      margin-left: @g;
    }
  }
  & when not (ispercentage(@g)) {
    .s-row {
      margin-left: -@g;
      > *[class*="s-col"] {
        border-left:0px solid rgba(0,0,0,0);
        border-right:0px solid rgba(0,0,0,0);
        border-left-width: @g;
      }
    }
    *[class*="s-col"] {
      width: 100%;
    }
  }
  & when (iskeyword(@c)) and not (@c = false) {
    .s-@{c}-hide {
      &, &[class*="s-button"] {
        display: none !important;
      }
    }
    .s-@{c}-show {
      &[class*="icon"], &[class*="s-button"], a&, span& {
        display: inline-block !important;
      }
      &, [class*="s-@{c}-stack"]>& {
        display: block !important;
      }
      &[class*="s-cell"] {
        display: table-cell !important;
      }
    }
    .s-@{c}-expand {
      display: block !important;
      width: 100% !important;
    }
    .s-@{c}-align-center {
      text-align: center !important;
    }
    .s-@{c}-align-left {
      text-align: left !important;
    }
    .s-@{c}-align-right {
      text-align: right !important;
    }
    [class*="s-@{c}-stack"] {
      float: none !important;
      width: 100%;
      &.s-layout>.s-layoutColumn {
        width: 100%;
      }
      &[class*='s-cells-group-spacing']>[class*='s-cells']>[class*='s-cell'] {
        padding-top: 0;
      }
      &, >*:not([class*="-hide"]), >*[class*="s-button"],
      &[class*='s-cells-group'], &[class*='s-cells-group']>[class*='s-cells'],  &[class*='s-cells-group']>[class*='s-cells']>[class*='s-cell'],
      &[class*="s-table"] table, &[class*="s-table"] table thead, &[class*="s-table"] table thead tr th,
      &[class*="s-table"] table tbody, &[class*="s-table"] table tr, &[class*="s-table"] table tbody tr td {
        display: block;
      }
      &[class*="s-table"] {
        th, td {
          padding-left: 0;
          padding-right: 0;
        }
        tr td + td, tr:first-child td {
          padding-top: 0 !important;
        }
        &[class*="-separated"] {
          tr:not(:first-child) {
            border-style: solid;
            border-width: 1px 0 0 0;
            td {
              border-top-width: 0;
            }
          }
        }
        &, &[class*='spacing'] {
          table td:not([class*=s-padding--]):not([class*="s-padding "]) {
            padding-left: 0;
            padding-right: 0;
          }
        }
      }
      &[class*="s-items"]>* + * {
        margin-left: 0 !important;
      }
      &[class*="s-cells"]>.s-cell {
        &:not([class*="s-padding-left"]):not([class*="s-padding--"]) {
          padding-left: 0 !important;  
        }
        &:not([class*="s-padding-right"]):not([class*="s-padding--"]) {
          padding-right: 0 !important;  
        }
      }
    }
    .s-@{c}-stack--xs>* + * {
      margin-top: @space-xs;
    }
    .s-@{c}-stack--s>* + * {
      margin-top: @space-s;
    }
    .s-@{c}-stack--m>* + *, .s-@{c}-stack>* + * {
      margin-top: @space;
    }
    .s-@{c}-stack--l>* + * {
      margin-top: @space-l;
    }
    .s-@{c}-stack--xl>* + * {
      margin-top: @space-xl;
    }
    .s-@{c}-stack--none>* + * {
      margin-top: 0;
    }
  }
  & when (@b = true) {
    .s-layout {
      &, >.s-layoutColumn, .s-layoutCell, .s-layoutRow {
        display: block;
        height: auto;
      }
    }
    *[class*="s-menu"] {
      >li {
        >*[class*="s-menu"] {
          bottom: 0 !important;
          left: 0 !important;
          position: relative !important;
          right: 0 !important;
          top: 0 !important;
          &[class*="-horizontal"]>li {
            display: block;
            float: none;
          }
        }
        &:hover>*[class*="s-menu"] {
          display: none !important;
        }
        &:focus {
          display: none !important;
        }
      }
    }
  }
}

// Grid System Generator
.createViewport(@class:false, @customStyles: false, @viewportMinWidth:false, @viewportMaxWidth:false, @cols:12, @colsGutter:20px, @stackLayout:false, @wrapperMinWidth:0, @wrapperMaxWidth:100%, @wrapperMargin:0, @windowMinWidth:false) {
  & when (isnumber(@viewportMinWidth)) and (isnumber(@viewportMaxWidth)) {
    & when not (@class = false) {
      .showFeature(@class)
    }
    @media screen and (min-width: @viewportMinWidth) and (max-width: @viewportMaxWidth) {
      .viewportFeatures();
      .generateColumns();
    }
  }
  & when (isnumber(@viewportMinWidth)) and (@viewportMaxWidth = false) {
    & when not (@class = false) {
      .showFeature(@class)
    }
    @media screen and (min-width: @viewportMinWidth) {
      .viewportFeatures();
      .generateColumns();
    }
  }
  & when (isnumber(@viewportMaxWidth)) and (@viewportMinWidth = false) {
    & when not (@class = false) {
      .showFeature(@class)
    }
    @media screen and (max-width: @viewportMaxWidth) {
      .viewportFeatures();
      .generateColumns();
    }
  }
}